Corrigi todos os bugs com esse codigo aqui